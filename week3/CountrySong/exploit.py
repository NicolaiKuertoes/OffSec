
from Crypto.Cipher import AES
from Crypto.Util import Padding

file = open('output.txt', 'r')
lines = file.readlines()

iv      = (lines[0])[:32] # first 16 bytes
output  = (lines[0])[32:-1] # enryptet png
key1    = (lines[1])[:-1] # 13 bytes
key2    = (lines[2])[:-1] # 13 bytes

def bruteForceKey(key):
    count = 0
    for _ in range(6):
        key += str(0)
    key = bytearray(bytes.fromhex(key))

    for i in range(255):
        for j in range(255):
            for k in range(255):
                count += 1
                key[13] = i
                key[14] = j
                key[15] = k
                cipher = AES.new(bytes(key), AES.MODE_CBC, bytes.fromhex(iv))
                t_plain = cipher.decrypt(bytes.fromhex(output))
                print(t_plain)
    print(count)

bruteForceKey(key1)
