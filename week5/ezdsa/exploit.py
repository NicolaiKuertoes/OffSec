# Exploit for nc hackfest.redrocket.club 33003

import ecdsa
from ecdsa import SECP256k1
from hashlib import sha1

# usernames aka messages. and their shas
m1 = 'guest'
m2 = "nic"
z1 = int(sha1('guest'.encode()).hexdigest(), 16)
z2 = int(sha1('nic'.encode()).hexdigest(), 16)

# signatures given by service for m1, m2:
s1 = int('dcbb3cc4459ece3056c4defaaf352d98e031d252be3d3609fbc3cb00dbee0f88', 16)
s2 = int('e112c3c65e28947ab88bc00ce20cbcaf9fd775bb8e7dc5e0fb9ebc86bc347bc2', 16)

# same r for all signatures
r = 0x0589abade28762eea832854f89f6f144e4ef8ba27c03026f38eac070349b98a1

n = SECP256k1.order
k = (((z1 - z2) % n) * pow((s1 - s2), -1, n)) % n
# print("k: ",hex(k))
d = ((((s1 * k) % n) - z1) * pow(r, -1, n)) % n
# print("d: ", hex(d))
sk = ecdsa.SigningKey.from_secret_exponent(d, curve=SECP256k1)
print("token:\tadmin," + sk.sign(b'admin', k=k).hex())
